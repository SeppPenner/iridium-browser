From 21de84d8ebc51921f69dd8a24e12c246e9b60a52 Mon Sep 17 00:00:00 2001
From: Jan Engelhardt <jengelh@inai.de>
Date: Mon, 1 Jun 2015 17:14:34 +0200
Subject: [PATCH 42/62] google-cloud-messaging: disable experiment status check

This avoids trk:263 from triggering.
---
 components/gcm_driver/gcm_channel_status_request.cc | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/components/gcm_driver/gcm_channel_status_request.cc b/components/gcm_driver/gcm_channel_status_request.cc
index 7ace8e78f3eb4..20a91778e2f98 100644
--- a/components/gcm_driver/gcm_channel_status_request.cc
+++ b/components/gcm_driver/gcm_channel_status_request.cc
@@ -23,8 +23,10 @@ namespace gcm {
 
 namespace {
 
+#if 0
 const char kRequestContentType[] = "application/octet-stream";
 const char kGCMChannelTag[] = "gcm_channel";
+#endif
 const int kDefaultPollIntervalSeconds = 60 * 60;  // 60 minutes.
 const int kMinPollIntervalSeconds = 30 * 60;  // 30 minutes.
 
@@ -59,6 +61,7 @@ void GCMChannelStatusRequest::Start() {
   if (!url_loader_factory_)
     return;
 
+#if 0
   DCHECK(!simple_url_loader_);
 
   GURL request_url(channel_status_request_url_);
@@ -118,6 +121,9 @@ void GCMChannelStatusRequest::Start() {
       url_loader_factory_.get(),
       base::BindOnce(&GCMChannelStatusRequest::OnSimpleLoaderComplete,
                      base::Unretained(this)));
+#endif
+  // Simulate an empty response and disable GCM.
+  callback_.Run(false, false, 0);
 }
 
 void GCMChannelStatusRequest::OnSimpleLoaderComplete(
-- 
2.25.1

