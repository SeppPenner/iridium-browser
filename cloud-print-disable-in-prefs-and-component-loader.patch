From 12101f13f80121e700d222091c82f7d0ff7d8a69 Mon Sep 17 00:00:00 2001
From: Jan Engelhardt <jengelh@inai.de>
Date: Sat, 13 Sep 2014 16:55:12 +0200
Subject: [PATCH 24/62] cloud-print: disable in prefs and component loader

Cloud Print should normally be autodisabled if no printers are shared.
But maybe that is not enough(?) Probably also needs to gain a checkbox
in the settings. Revisit..]

Also changes the setting for notifications about new cloud printers to
be off by default.
---
 chrome/browser/extensions/component_loader.cc                 | 2 ++
 chrome/browser/ui/browser_ui_prefs.cc                         | 2 +-
 chrome/browser/ui/webui/local_discovery/local_discovery_ui.cc | 4 ----
 3 files changed, 3 insertions(+), 5 deletions(-)

diff --git a/chrome/browser/extensions/component_loader.cc b/chrome/browser/extensions/component_loader.cc
index 76129e19fe3fc..baef43000ace3 100644
--- a/chrome/browser/extensions/component_loader.cc
+++ b/chrome/browser/extensions/component_loader.cc
@@ -445,9 +445,11 @@ void ComponentLoader::AddDefaultComponentExtensions(
 #else  // defined(OS_CHROMEOS)
   DCHECK(!skip_session_components);
 #if BUILDFLAG(ENABLE_PRINTING)
+#if 0 /* IRIDIUM */
   // Cloud Print component app. Not required on Chrome OS.
   Add(IDR_CLOUDPRINT_MANIFEST,
       base::FilePath(FILE_PATH_LITERAL("cloud_print")));
+#endif
 #endif  // BUILDFLAG(ENABLE_PRINTING)
 #endif  // defined(OS_CHROMEOS)
 
diff --git a/chrome/browser/ui/browser_ui_prefs.cc b/chrome/browser/ui/browser_ui_prefs.cc
index bfbcbb30d0bb7..7a39b6506cb12 100644
--- a/chrome/browser/ui/browser_ui_prefs.cc
+++ b/chrome/browser/ui/browser_ui_prefs.cc
@@ -71,7 +71,7 @@ void RegisterBrowserUserPrefs(user_prefs::PrefRegistrySyncable* registry) {
       user_prefs::PrefRegistrySyncable::SYNCABLE_PREF);
   registry->RegisterStringPref(prefs::kCloudPrintEmail, std::string());
   registry->RegisterBooleanPref(prefs::kCloudPrintProxyEnabled, true);
-  registry->RegisterBooleanPref(prefs::kCloudPrintSubmitEnabled, true);
+  registry->RegisterBooleanPref(prefs::kCloudPrintSubmitEnabled, false);
   registry->RegisterDictionaryPref(prefs::kBrowserWindowPlacement);
   registry->RegisterDictionaryPref(prefs::kBrowserWindowPlacementPopup);
   registry->RegisterDictionaryPref(prefs::kAppWindowPlacement);
diff --git a/chrome/browser/ui/webui/local_discovery/local_discovery_ui.cc b/chrome/browser/ui/webui/local_discovery/local_discovery_ui.cc
index 4b2a6a713f2aa..3002e439d17f4 100644
--- a/chrome/browser/ui/webui/local_discovery/local_discovery_ui.cc
+++ b/chrome/browser/ui/webui/local_discovery/local_discovery_ui.cc
@@ -107,10 +107,6 @@ void LocalDiscoveryUI::RegisterProfilePrefs(
     user_prefs::PrefRegistrySyncable* registry) {
   registry->RegisterBooleanPref(
       prefs::kLocalDiscoveryNotificationsEnabled,
-#if defined(OS_WIN)
       false,
-#else
-      true,
-#endif
       user_prefs::PrefRegistrySyncable::SYNCABLE_PREF);
 }
-- 
2.25.0

