From 7770ba4a1cf5f3e945383734433462b378490065 Mon Sep 17 00:00:00 2001
From: Jan Engelhardt <jengelh@inai.de>
Date: Thu, 20 Apr 2017 16:25:49 +0200
Subject: [PATCH 01/59] build: remove calling untrusted hooks

Avoid downloading untrusted executables and wasting time with a
sysroot.
---
 DEPS | 238 +------------------------------------------------------------------
 1 file changed, 3 insertions(+), 235 deletions(-)

diff --git a/DEPS b/DEPS
index d9d56e2ad8df..9a56e8982062 100644
--- a/DEPS
+++ b/DEPS
@@ -32,16 +32,14 @@ vars = {
   'checkout_android_sdk_sources': False,
   'checkout_configuration':
     'default',
-  'checkout_instrumented_libraries':
-    'checkout_linux and checkout_configuration == "default"',
+  'checkout_instrumented_libraries': False,
   'checkout_libaom': True,
-  'checkout_nacl': True,
+  'checkout_nacl': False,
   'checkout_oculus_sdk':
     'checkout_src_internal and checkout_win',
   'checkout_src_internal': False,
   'checkout_telemetry_dependencies': False,
-  'checkout_traffic_annotation_tools':
-    'checkout_configuration == "default"',
+  'checkout_traffic_annotation_tools': False,
   'chromium_git':
     'https://chromium.googlesource.com',
   'cros_board':
@@ -1385,71 +1383,6 @@ hooks = [
     'condition':
       'checkout_nacl'
   },
-  {
-    'action': [
-      'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--arch=arm'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot_arm',
-    'condition':
-      'checkout_linux and checkout_arm'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--arch=arm64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot_arm64',
-    'condition':
-      'checkout_linux and checkout_arm64'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--arch=x86'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot_x86',
-    'condition':
-      'checkout_linux and (checkout_x86 or checkout_x64)'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--arch=mips'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot_mips',
-    'condition':
-      'checkout_linux and checkout_mips'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--arch=x64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot_x64',
-    'condition':
-      'checkout_linux and checkout_x64'
-  },
   {
     'action': [
       'python',
@@ -1494,28 +1427,6 @@ hooks = [
     'condition':
       'checkout_ios or checkout_mac'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/binutils/download.py'
-    ],
-    'pattern':
-      'src/third_party/binutils',
-    'name':
-      'binutils',
-    'condition':
-      'host_os == "linux"'
-  },
-  {
-    'action': [
-      'python',
-      'src/tools/clang/scripts/update.py'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang'
-  },
   {
     'action': [
       'python',
@@ -1607,24 +1518,6 @@ hooks = [
     'condition':
       'host_os == "mac"'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '--bucket',
-      'chromium-gn',
-      '-s',
-      'src/buildtools/linux64/gn.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'gn_linux64',
-    'condition':
-      'host_os == "linux"'
-  },
   {
     'action': [
       'python',
@@ -1661,24 +1554,6 @@ hooks = [
     'condition':
       'host_os == "mac"'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '--bucket',
-      'chromium-clang-format',
-      '-s',
-      'src/buildtools/linux64/clang-format.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang_format_linux',
-    'condition':
-      'host_os == "linux"'
-  },
   {
     'action': [
       'python',
@@ -1733,24 +1608,6 @@ hooks = [
     'condition':
       'checkout_win and host_os == "linux"'
   },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--extract',
-      '--no_auth',
-      '--bucket',
-      'chromium-fonts',
-      '-s',
-      'src/third_party/test_fonts/test_fonts.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'test_fonts',
-    'condition':
-      'checkout_linux or (checkout_android or checkout_fuchsia)'
-  },
   {
     'action': [
       'python',
@@ -1805,24 +1662,6 @@ hooks = [
     'condition':
       'host_os == "mac"'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '--bucket',
-      'chromium-luci',
-      '-d',
-      'src/tools/luci-go/linux64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'luci-go_linux',
-    'condition':
-      'host_os == "linux"'
-  },
   {
     'action': [
       'python',
@@ -1895,42 +1734,6 @@ hooks = [
     'condition':
       'checkout_instrumented_libraries'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '-u',
-      '--bucket',
-      'v8-wasm-fuzzer',
-      '-s',
-      'src/v8/test/fuzzer/wasm_corpus.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'wasm_fuzzer'
-  },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--extract',
-      '--no_auth',
-      '--bucket',
-      'chromium-nodejs/8.9.1',
-      '-s',
-      'src/third_party/node/linux/node-linux-x64.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'node_linux64',
-    'condition':
-      'host_os == "linux"'
-  },
   {
     'action': [
       'python',
@@ -2061,23 +1864,6 @@ hooks = [
     'condition':
       'host_os == "win" and checkout_traffic_annotation_tools'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '--num_threads=4',
-      '--bucket',
-      'chromium-binary-patching',
-      '-d',
-      'src/components/zucchini/testdata'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'zucchini_testdata'
-  },
   {
     'action': [
       'src/build/cipd/clobber_cipd_root.py',
@@ -2116,24 +1902,6 @@ hooks = [
     'condition':
       'checkout_android'
   },
-  {
-    'action': [
-      'python',
-      'src/third_party/depot_tools/download_from_google_storage.py',
-      '--no_resume',
-      '--no_auth',
-      '--bucket',
-      'chromium-android-tools/checkstyle',
-      '-s',
-      'src/third_party/checkstyle/checkstyle-8.0-all.jar.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'checkstyle',
-    'condition':
-      'checkout_android or checkout_linux'
-  },
   {
     'action': [
       'python',
-- 
2.16.3

