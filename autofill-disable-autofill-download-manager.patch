From b72749b9ba6aa6e76777920f8f5a643f405da87c Mon Sep 17 00:00:00 2001
From: Jan Engelhardt <jengelh@inai.de>
Date: Thu, 11 Sep 2014 16:37:32 +0200
Subject: [PATCH 10/58] autofill: disable autofill download manager

Disables the autofill download manager (trk:158).
---
 components/autofill/core/browser/autofill_download_manager.cc | 2 +-
 components/autofill/core/browser/autofill_manager.cc          | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/components/autofill/core/browser/autofill_download_manager.cc b/components/autofill/core/browser/autofill_download_manager.cc
index adeb0145dd79..1bb57679b0af 100644
--- a/components/autofill/core/browser/autofill_download_manager.cc
+++ b/components/autofill/core/browser/autofill_download_manager.cc
@@ -83,7 +83,7 @@ const net::BackoffEntry::Policy kAutofillBackoffPolicy = {
 };
 
 const char kDefaultAutofillServerURL[] =
-    "https://clients1.google.com/tbproxy/af/";
+    "trk:158:https://clients1.google.com/tbproxy/af/";
 
 // Header for API key.
 constexpr char kGoogApiKey[] = "X-Goog-Api-Key";
diff --git a/components/autofill/core/browser/autofill_manager.cc b/components/autofill/core/browser/autofill_manager.cc
index 95dcd22455cf..9abef350550b 100644
--- a/components/autofill/core/browser/autofill_manager.cc
+++ b/components/autofill/core/browser/autofill_manager.cc
@@ -1287,11 +1287,13 @@ AutofillManager::AutofillManager(
       weak_ptr_factory_(this) {
   DCHECK(driver);
   DCHECK(client_);
+#if 0
   if (enable_download_manager == ENABLE_AUTOFILL_DOWNLOAD_MANAGER) {
     version_info::Channel channel = client_->GetChannel();
     download_manager_.reset(
         new AutofillDownloadManager(driver, this, GetAPIKeyForUrl(channel)));
   }
+#endif
   CountryNames::SetLocaleString(app_locale_);
   // Since we want Downstream to still work in incognito, only overwrite the
   // PDM's sync service if this is not an incognito AutofillManager. However, if
-- 
2.21.0

